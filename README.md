# 语言
English:
https://github.com/Potato-is-rotten/Time-Controller/blob/main/README%20eng.md

# Screen Time Controller

Windows 11 屏幕时间管控器应用程序，帮助您控制和管理屏幕使用时间。

## 功能特性

- **每日屏幕时间限制**：为每天设置不同的屏幕时间限制
- **Windows 服务形式**：支持以 Windows 服务形式运行，实现开机自动启动
- **全窗口时间记录**：记录所有窗口打开时间（无论是否有焦点）
- **应用级别时间记录**：区分不同应用的使用时间，详细记录每个应用的焦点时间
- **时间限制警告**：在达到时间限制前5分钟发送警告通知
- **屏幕锁定**：当达到时间限制时自动锁定屏幕
- **密码保护**：设置密码保护，防止未经授权修改设置
- **系统托盘集成**：最小化到系统托盘，不干扰正常工作
- **实时时间跟踪**：实时显示已使用时间和剩余时间
- **设置保持**：更改设置后，今日使用时间不重置

## 安装说明

### 系统要求
- Windows 11
- .NET 10.0 或更高版本

### 安装步骤
1. 下载项目
2. 点击程序'ScreenTimeController.exe'运行

## 使用方法

### 首次启动
1. 应用程序将自动启动并最小化到系统托盘
2. 右键点击系统托盘图标，选择 "Settings" 打开设置窗口
3. 设置每天的屏幕时间限制
4. 设置密码保护（可选）
5. 点击 "OK" 保存设置

### 日常使用
- **查看状态**：右键点击系统托盘图标，选择 "Show" 查看当前使用情况
- **修改设置**：右键点击系统托盘图标，选择 "Settings" 修改设置（需要输入密码）
- **退出应用**：右键点击系统托盘图标，选择 "Exit" 退出应用程序

### 时间限制设置
- 可以为每天设置不同的时间限制
- 使用 "Apply to All" 按钮将当前设置应用到所有天
- 时间限制以小时和分钟为单位

## 技术实现

### 核心组件
- **MainForm**：主应用程序窗口，显示时间使用情况和控制选项
- **ScreenTimeService**：Windows 服务类，实现服务形式运行
- **SettingsForm**：设置窗口，用于配置每天的时间限制和密码
- **TimeTracker**：时间跟踪器，记录屏幕使用时间和应用级别使用时间
- **SettingsManager**：设置管理器，保存和加载应用程序设置
- **WindowHelper**：Windows API 包装器，用于获取窗口信息和锁定屏幕

### 数据存储
- 设置保存在 `%AppData%\ScreenTimeController\settings.txt` 文件中
- 总时间使用记录保存在 `%AppData%\ScreenTimeController\usage.txt` 文件中
- 应用级别时间使用记录保存在 `%AppData%\ScreenTimeController\app_usage.txt` 文件中
- 密码使用 SHA256 加密存储

### 关键技术
- Windows Forms 应用程序开发
- Windows 服务开发
- Windows API 集成
- 时间跟踪和管理
- 系统托盘集成
- 文件-based 数据存储
- 密码加密

## 故障排除

### 应用程序无法启动
1. 确保安装了 .NET 10.0 或更高版本
2. 检查应用程序权限
3. 查看 Windows 事件查看器中的错误信息

### 时间限制不生效
1. 检查设置是否正确保存
2. 确保应用程序正在运行（在系统托盘中可见）
3. 重启应用程序

### 忘记密码
1. 关闭应用程序
2. 删除 `%AppData%\ScreenTimeController\settings.txt` 文件
3. 重新启动应用程序，设置新密码

### 服务无法启动
1. 确保以管理员身份安装服务
2. 检查服务依赖项
3. 查看 Windows 事件查看器中的服务错误信息

## 许可证

Apache License 2.0

